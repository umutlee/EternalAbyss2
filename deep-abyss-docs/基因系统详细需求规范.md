# 《深渊巢穴》基因系统详细需求规范

## 1. 系统概述

### 1.1 系统目的

基因系统是《深渊巢穴》游戏的核心创新机制，旨在提供一个深度、复杂且高度可定制的单位进化系统。该系统允许玩家通过基因操作来改变生物单位的属性、能力和外观，实现独特的游戏体验和策略深度。

### 1.2 系统范围

基因系统负责：
- 基因的生成、获取、存储和管理
- 基因对单位属性和能力的影响
- 基因融合、突变和进化机制
- 基因市场交易功能
- 基因可视化和编辑界面

基因系统不负责：
- 单位的基本移动和战斗逻辑
- 资源收集和管理
- 母巢建设和扩张

### 1.3 系统依赖

基因系统依赖于：
- 单位系统：应用基因效果
- 资源系统：基因操作消耗资源
- UI系统：展示基因信息和操作界面
- 存储系统：保存基因数据

## 2. 基因属性详细定义

### 2.1 基础属性

| 属性名称 | 属性类型 | 取值范围 | 默认值 | 影响效果 | 视觉表现 |
|---------|---------|---------|-------|---------|---------|
| 攻击性 | 浮点数 | 0.1-10.0 | 1.0 | 提高单位攻击力(×攻击性值)，增加主动攻击范围(+攻击性值×5)，降低防御力(×(2-攻击性值/10)) | 单位外观更具侵略性，体表尖刺增多，颜色偏红，攻击动画更加迅猛 |
| 防御性 | 浮点数 | 0.1-10.0 | 1.0 | 提高单位防御力(×防御性值)，增加生命值(×防御性值)，降低移动速度(×(2-防御性值/5)) | 单位外观更加厚重，甲壳增厚，颜色偏蓝，受击动画更有韧性 |
| 适应性 | 浮点数 | 0.1-10.0 | 1.0 | 提高环境适应能力(减少环境负面效果×适应性值/10)，增加资源获取效率(×适应性值/2)，提高突变成功率(+适应性值×2%) | 单位外观更加多变，表皮纹理复杂，颜色偏绿，具有变色龙效果 |
| 繁殖力 | 浮点数 | 0.1-10.0 | 1.0 | 提高单位生产速度(×繁殖力值/2)，降低单位成本(×(2-繁殖力值/10))，增加同时生产数量上限(+繁殖力值/2，向下取整) | 单位外观更加丰满，生殖器官明显，颜色偏黄，具有脉动效果 |
| 突变性 | 浮点数 | 0.1-10.0 | 1.0 | 增加基因突变几率(+突变性值×3%)，提高突变幅度(×突变性值/2)，降低稳定性(随机属性波动±突变性值×5%) | 单位外观不稳定，形态经常微小变化，颜色偏紫，具有闪烁效果 |

### 2.2 高级属性

| 属性名称 | 属性类型 | 取值范围 | 默认值 | 影响效果 | 视觉表现 | 解锁条件 |
|---------|---------|---------|-------|---------|---------|---------|
| 群体意识 | 浮点数 | 0.0-5.0 | 0.0 | 相同类型单位在附近时获得属性加成(+群体意识值×2%)，共享视野，协同攻击伤害提升(×群体意识值/4) | 单位之间有能量丝连接，颜色同步变化，攻击时光效共鸣 | 拥有5个相同类型单位 |
| 自愈能力 | 浮点数 | 0.0-5.0 | 0.0 | 受伤后自动恢复生命值(每秒+最大生命值×自愈能力值×0.5%)，减少负面状态持续时间(×(1-自愈能力值/10)) | 受伤部位有蠕动修复效果，伤口处发光，恢复时有绿色能量波动 | 单位存活超过10分钟 |
| 能量效率 | 浮点数 | 0.0-5.0 | 0.0 | 降低能量消耗(×(1-能量效率值/10))，提高能量储存上限(×能量效率值/2)，加快能量恢复速度(×能量效率值/4) | 单位能量部位更加明亮，运动时能量波纹更加流畅，待机时能量脉动更加规律 | 消耗1000点能量 |
| 智能水平 | 浮点数 | 0.0-5.0 | 0.0 | 提高自主决策能力，增加技能使用效率(×智能水平值/2)，解锁高级行为模式，提高对敌人弱点的识别能力(+暴击率智能水平值×3%) | 头部/控制中枢更加发达，眼睛/感知器官更加明亮，行动更加谨慎和有策略性 | 单位击杀10个敌人 |
| 进化潜力 | 浮点数 | 0.0-5.0 | 0.0 | 提高进化速度(×进化潜力值/2)，降低进化资源需求(×(1-进化潜力值/10))，增加进化成功率(+进化潜力值×5%)，解锁稀有进化路径 | 单位体表有特殊进化标记，成长点发光，静息时有能量积累现象 | 完成一次进化 |

## 3. 基因类型与克制关系

### 3.1 基因类型详细定义

| 基因类型 | 主要特性 | 优势 | 劣势 | 视觉特征 | 获取方式 | 稀有度 |
|---------|---------|------|------|---------|---------|-------|
| 酸性基因 | 侵蚀性强，适合攻击 | 对有机物伤害+50%，穿透防御，持续伤害 | 自身受到5%反伤，寿命减少20% | 流动的酸性液体纹理，绿色荧光，表面冒泡 | 酸性环境采集，分解特殊生物 | ★★★ |
| 碱性基因 | 稳定性高，适合防御 | 减伤30%，净化负面效果，反弹伤害10% | 移动速度-15%，攻击速度-10% | 结晶状表面，蓝色光泽，稳定的几何形态 | 碱性环境采集，净化污染区域 | ★★ |
| 金属基因 | 坚固耐用，适合持久战 | 护甲+100%，反射能量攻击，免疫控制效果 | 能量消耗+30%，电击伤害+50% | 金属质感表面，机械化部件，冷色调光泽 | 矿区采集，回收机械单位 | ★★★★ |
| 有机基因 | 适应性强，成长快 | 自愈能力+30%，繁殖速度+50%，资源消耗-20% | 物理防御-25%，易受疾病影响 | 柔软多肉质感，有机纹理，温暖色调，生长变化明显 | 生物区采集，吸收有机物 | ★ |
| 能量基因 | 高能高效，爆发力强 | 能量攻击+100%，移动速度+30%，冷却时间-20% | 持续作战能力弱，能量耗尽后虚弱 | 明亮的能量脉络，半透明发光效果，动态能量流动 | 能量场采集，吸收能量生物 | ★★★★★ |
| 虚空基因 | 神秘莫测，难以预测 | 随机增益效果，隐身能力，免疫部分伤害 | 不稳定性，随机负面效果，难以控制 | 扭曲的空间效果，深邃的黑色与紫色，偶尔闪现的符文 | 虚空裂缝采集，吸收异次元生物 | ★★★★★ |
| 原始基因 | 基础稳定，适应性强 | 无明显弱点，适应所有环境，进化潜力高 | 无明显优势，各项属性中庸 | 简单基础的生物形态，中性色调，结构简单清晰 | 初始单位自带，基础环境采集 | ★ |
| 合成基因 | 人工设计，高度专精 | 特定属性极高，精确的功能设计 | 适应性差，进化潜力低，维护成本高 | 规则的几何图案，人工合成质感，色彩鲜明对比强烈 | 实验室合成，特殊任务奖励 | ★★★ |

### 3.2 基因克制关系表

| 攻击方\防御方 | 酸性基因 | 碱性基因 | 金属基因 | 有机基因 | 能量基因 | 虚空基因 | 原始基因 | 合成基因 |
|-------------|---------|---------|---------|---------|---------|---------|---------|---------|
| 酸性基因 | 100% | 50% | 150% | 150% | 100% | 75% | 100% | 125% |
| 碱性基因 | 50% | 100% | 150% | 100% | 75% | 100% | 100% | 125% |
| 金属基因 | 75% | 75% | 100% | 150% | 50% | 100% | 100% | 125% |
| 有机基因 | 75% | 100% | 75% | 100% | 100% | 125% | 100% | 75% |
| 能量基因 | 100% | 125% | 150% | 100% | 100% | 50% | 100% | 150% |
| 虚空基因 | 125% | 100% | 100% | 75% | 150% | 100% | 100% | 50% |
| 原始基因 | 100% | 100% | 100% | 100% | 100% | 100% | 100% | 100% |
| 合成基因 | 75% | 75% | 75% | 125% | 75% | 150% | 100% | 100% |

*注：表中数值表示攻击方对防御方造成的伤害百分比，100%为标准伤害*

## 4. 基因操作机制

### 4.1 基因获取方式

| 获取方式 | 描述 | 获取难度 | 获取品质 | 视觉表现 | 交互流程 |
|---------|------|---------|---------|---------|---------|
| 环境采集 | 从特定环境中提取基因样本 | ★★ | 基础-稀有 | 单位接触环境，出现采集光效，环境微粒被吸收 | 选择单位→指定环境→开始采集→完成采集→获得基因 |
| 生物分解 | 分解击败的生物单位获取基因 | ★★★ | 普通-史诗 | 目标单位被分解，DNA螺旋显现，基因片段被提取 | 击败单位→选择分解→分解动画→获得基因 |
| 实验室合成 | 在实验室中人工合成基因 | ★★★★ | 稀有-传说 | 实验室设备运行，试管中液体变色，DNA合成动画 | 选择基因模板→投入资源→启动合成→等待完成→获得基因 |
| 基因融合 | 融合两个已有基因创造新基因 | ★★★ | 取决于原材料 | 两条DNA链交织融合，产生新的基因链 | 选择两个基因→放入融合器→启动融合→融合动画→获得新基因 |
| 突变诱导 | 对现有基因施加突变因子 | ★★★★ | 不确定 | 基因链扭曲变形，随机片段重组，闪烁不稳定光效 | 选择基因→添加突变因子→启动突变→随机结果→获得变异基因 |
| 市场交易 | 在基因市场购买其他玩家的基因 | ★ | 全范围 | 市场界面交易动画，资源与基因交换 | 浏览市场→选择基因→支付资源→确认交易→获得基因 |
| 任务奖励 | 完成特定任务获得稀有基因 | ★★★★ | 稀有-传说 | 任务完成特效，奖励展示动画 | 接受任务→完成目标→提交任务→获得基因奖励 |
| 深渊探索 | 在深渊区域发现远古基因 | ★★★★★ | 史诗-传说 | 深渊能量波动，远古遗迹激活，基因容器开启 | 探索深渊→发现遗迹→解锁容器→获得远古基因 |

### 4.2 基因融合详细规则

| 融合类型 | 成功率 | 资源消耗 | 结果预测 | 特殊效果 | 视觉表现 |
|---------|-------|---------|---------|---------|---------|
| 同类融合 | 90% | 低 | 高度可预测，属性提升 | 10%几率产生突变 | 平稳的融合光效，相似DNA链合并 |
| 互补融合 | 75% | 中 | 可预测，获得双方优势 | 25%几率产生新特性 | 和谐的融合光效，互补DNA链交织 |
| 对立融合 | 50% | 高 | 难以预测，高风险高回报 | 50%几率产生全新基因类型 | 剧烈的融合反应，对立DNA链冲突后重组 |
| 催化融合 | 95% | 特殊催化剂 | 可控方向，精确结果 | 根据催化剂产生特定效果 | 受控的融合过程，催化剂引导DNA重组 |
| 多重融合 | 30% | 极高 | 极难预测，混沌结果 | 70%几率产生前所未有的基因 | 复杂的多重融合动画，多条DNA链交织重组 |

#### 4.2.1 融合公式

基础融合公式：
```
结果属性值 = (基因A属性值 + 基因B属性值) / 2 + 随机波动值
随机波动值 = ±(基因A突变性 + 基因B突变性) / 10
```

特殊融合组合：
1. 酸性 + 碱性 = 50%几率获得中和基因（特殊稳定型）
2. 金属 + 能量 = 30%几率获得导能基因（特殊攻击型）
3. 有机 + 虚空 = 20%几率获得异维基因（特殊防御型）
4. 原始 + 任意高级基因 = 提高高级基因纯度
5. 合成 + 自然基因 = 40%几率获得混合基因（平衡型）

### 4.3 基因突变机制

| 突变类型 | 触发条件 | 突变幅度 | 风险等级 | 视觉效果 | 可控性 |
|---------|---------|---------|---------|---------|-------|
| 自然突变 | 时间推移，环境影响 | 低 | ★ | 缓慢的基因链微调，轻微颜色变化 | 不可控 |
| 诱导突变 | 使用突变催化剂 | 中 | ★★ | 基因链部分重组，明显的结构变化 | 部分可控 |
| 辐射突变 | 暴露于辐射环境 | 高 | ★★★★ | 剧烈的基因断裂重组，强烈的色彩变化 | 几乎不可控 |
| 深渊突变 | 接触深渊能量 | 极高 | ★★★★★ | 基因结构完全重构，异常的视觉效果 | 完全不可控 |
| 定向突变 | 使用基因编辑器 | 精确 | ★★ | 精确的基因片段替换，可视化编辑过程 | 高度可控 |

#### 4.3.1 突变结果计算

```
突变后属性值 = 原属性值 × (1 + 突变方向 × 突变幅度)
突变方向 = [-1, 1]之间的随机值
突变幅度 = 基础突变率 × 突变性属性值 × 环境因子
```

突变可能产生的特殊结果：
1. 有益突变：属性值显著提升，获得新能力
2. 有害突变：属性值下降，获得负面特性
3. 中性突变：属性值小幅波动，无明显影响
4. 致命突变：单位不稳定，可能导致解体（低概率）
5. 飞跃突变：解锁全新进化路径（极低概率）

## 5. 基因可视化与UI设计

### 5.1 基因编辑器界面

| 界面元素 | 位置 | 功能 | 交互方式 | 视觉风格 | 反馈效果 |
|---------|------|------|---------|---------|---------|
| 基因链视图 | 中央上方 | 显示基因结构 | 点击片段查看详情，拖拽重排 | DNA螺旋3D模型，高亮活跃区域 | 选中片段放大，修改时实时变化 |
| 属性面板 | 右侧 | 显示基因属性 | 点击属性查看详情，滑动调整 | 科技感数据面板，属性条形图 | 调整时属性条动态变化，数值实时更新 |
| 基因库 | 左侧 | 显示已有基因 | 点击选择，拖拽到编辑区 | 分类整理的基因样本架，缩略图预览 | 选中时样本发光，拖拽时跟随鼠标 |
| 操作工具栏 | 底部 | 提供编辑工具 | 点击选择工具 | 科学仪器风格的工具图标 | 选中工具高亮，使用时有对应动画 |
| 预览窗口 | 中央下方 | 显示编辑结果 | 旋转查看不同角度 | 3D生物单位预览，突出基因影响 | 编辑时实时更新，变化部位高亮 |
| 保存/应用按钮 | 右下角 | 保存或应用更改 | 点击确认 | 醒目的按钮设计，科技感边框 | 点击时波纹效果，成功时绿色确认动画 |

### 5.2 基因视觉表现系统

| 基因特性 | 视觉元素 | 动态效果 | 颜色方案 | 粒子效果 | 声音反馈 |
|---------|---------|---------|---------|---------|---------|
| 基因类型 | 单位主体纹理 | 静息状态的微动作 | 主色调决定 | 环绕粒子效果 | 单位音色基调 |
| 攻击性 | 尖刺/武器结构 | 攻击动作速度和幅度 | 红色系强度 | 攻击时的破坏粒子 | 攻击音效的锐利度 |
| 防御性 | 甲壳/护盾结构 | 受击反应和姿态 | 蓝色系强度 | 防御时的能量波纹 | 受击音效的沉闷度 |
| 适应性 | 表皮纹理复杂度 | 环境适应变色效果 | 绿色系强度 | 适应时的环境交互粒子 | 环境响应音效 |
| 繁殖力 | 生殖器官显著度 | 脉动和生长动画 | 黄色系强度 | 繁殖时的生命能量粒子 | 生长和繁殖音效 |
| 突变性 | 形态不稳定度 | 随机微变形动画 | 紫色系强度 | 不稳定能量闪烁 | 变异和不稳定音效 |

### 5.3 基因市场界面

| 界面元素 | 位置 | 功能 | 交互方式 | 视觉风格 | 数据显示 |
|---------|------|------|---------|---------|---------|
| 市场列表 | 左侧 | 显示可交易基因 | 滚动浏览，点击查看详情 | 科技感列表，基因缩略图 | 基因类型，稀有度，价格 |
| 详情面板 | 右侧 | 显示选中基因详情 | 点击按钮交易 | 详细的基因数据展示 | 完整属性，来源，评级 |
| 搜索筛选 | 顶部 | 筛选基因列表 | 输入关键词，选择筛选条件 | 简洁的搜索界面 | 筛选条件可视化 |
| 交易历史 | 底部 | 显示历史交易 | 点击查看详情 | 时间轴形式的历史记录 | 交易时间，价格，交易方 |
| 我的基因 | 右上角 | 管理自己的基因 | 点击上架或下架 | 个人基因库界面 | 持有数量，上架状态 |
| 市场趋势 | 左上角 | 显示市场行情 | 点击查看详细趋势 | 数据图表，趋势箭头 | 价格走势，热门基因 |

## 6. 基因系统与其他系统的交互

### 6.1 与单位系统的交互

| 交互点 | 基因系统职责 | 单位系统职责 | 数据流向 | 触发条件 | 视觉反馈 |
|-------|------------|------------|---------|---------|---------|
| 基因应用 | 提供基因数据和效果计算 | 接收并应用到单位属性 | 基因系统→单位系统 | 玩家应用基因到单位 | 单位外观变化，属性面板更新 |
| 基因表达 | 决定基因外观和特效 | 渲染单位模型和动画 | 基因系统→单位系统 | 基因激活或变化 | 单位模型更新，特效生成 |
| 基因提取 | 从单位中提取基因数据 | 提供单位当前基因信息 | 单位系统→基因系统 | 玩家执行提取操作 | 提取动画，基因库更新 |
| 进化触发 | 提供进化条件和路径 | 执行单位进化过程 | 双向 | 满足进化条件 | 进化动画，单位形态变化 |
| 突变反馈 | 计算突变结果 | 应用突变效果到单位 | 基因系统→单位系统 | 突变事件触发 | 突变视觉效果，单位不稳定动画 |

### 6.2 与资源系统的交互

| 交互点 | 基因系统职责 | 资源系统职责 | 资源类型 | 消耗计算 | 优化机制 |
|-------|------------|------------|---------|---------|---------|
| 基因操作消耗 | 定义操作成本 | 扣除相应资源 | 生物质，能量，催化剂 | 基于操作类型和基因复杂度 | 高效基因可降低消耗 |
| 基因产出加成 | 提供资源加成系数 | 应用加成到资源产出 | 所有资源类型 | 基于基因属性和特性 | 特殊基因可提高特定资源产出 |
| 特殊资源解锁 | 定义解锁条件 | 添加新资源类型 | 高级生物质，稀有元素 | 基于基因组合和突变 | 解锁新资源时的特殊动画 |
| 资源转化效率 | 提供转化系数 | 执行资源转化 | 资源间的转化 | 基于基因效率属性 | 高效基因可提高转化比率 |
| 维护消耗 | 计算基因稳定性消耗 | 定期扣除维护资源 | 能量，稳定剂 | 基于基因复杂度和不稳定性 | 优化基因可降低维护成本 |

### 6.3 与母巢系统的交互

| 交互点 | 基因系统职责 | 母巢系统职责 | 影响范围 | 触发机制 | 战略意义 |
|-------|------------|------------|---------|---------|---------|
| 菌毯特性 | 决定菌毯基因特性 | 应用特性到菌毯扩张 | 整个菌毯区域 | 母巢基因更新 | 影响领土扩张策略 |
| 环境适应 | 提供环境适应系数 | 调整在不同环境的表现 | 特定环境区域 | 进入新环境 | 决定可拓展的区域 |
| 单位生产 | 提供基因模板 | 基于模板生产单位 | 新生产的单位 | 单位生产指令 | 决定军队组成策略 |
| 防御机制 | 决定免疫系统特性 | 应用到母巢防御 | 母巢