# 建筑系统详细需求规范

## 1. 系统概述

### 1.1 系统定位

建筑系统是《深渊巢穴》游戏中的核心系统之一，负责提供玩家扩张领地、收集资源、研究技术、生产单位和防御基地的能力。与传统RTS游戏不同，本游戏的建筑系统具有有机性和进化性，建筑物会随着菌毯的扩张而生长、变异和适应环境。

### 1.2 系统目标

- 提供独特的有机建筑体验，区别于传统RTS的机械化建筑
- 实现建筑与菌毯系统的深度融合，建筑依赖菌毯生长
- 支持建筑的进化和变异，响应环境和玩家选择
- 平衡建筑的功能性与资源消耗，提供策略性选择
- 通过建筑视觉设计强化游戏的生物科幻氛围

### 1.3 系统定义

建筑系统定义为一系列可在菌毯上建造的有机结构，这些结构具有特定功能，如资源收集、单位生产、研究、防御等。建筑物从菌毯中生长出来，会随时间和环境条件发生变化，可以进化为更高级的形态。

## 2. 建筑类型与功能

### 2.1 核心建筑

#### 2.1.1 主巢室（Hive Core）

- **功能**：游戏的核心建筑，代表玩家的主基地
- **特性**：
  - 生产基础工作单位
  - 提供基础资源存储
  - 解锁初始建筑和技术
  - 主巢室被摧毁则游戏失败
- **进化路径**：可升级为高级主巢室，增加生产效率和存储容量
- **资源消耗**：初始建筑，不需要资源建造，但升级需要大量资源
- **建造限制**：每个玩家只能拥有1个

#### 2.1.2 次级巢室（Sub-Hive）

- **功能**：扩展领地的次级核心建筑
- **特性**：
  - 扩展菌毯覆盖范围
  - 提供额外的资源存储
  - 允许在远离主巢室的区域建造建筑
- **进化路径**：可升级为专业化巢室（资源型、军事型、研究型）
- **资源消耗**：中等（生物质150，能量100）
- **建造限制**：最多同时存在5个

### 2.2 资源建筑

#### 2.2.1 养分提取器（Nutrient Extractor）

- **功能**：收集基础资源——生物质
- **特性**：
  - 从周围环境中提取生物质
  - 效率受周围环境生物丰富度影响
  - 可自动将资源运送至最近的存储建筑
- **进化路径**：高效提取器、专业化提取器（针对特定环境）
- **资源消耗**：低（生物质50，能量30）
- **建造限制**：必须建在菌毯上，与其他提取器保持最小距离

#### 2.2.2 能量节点（Energy Node）

- **功能**：收集能量资源
- **特性**：
  - 从环境中吸收能量（阳光、热能、化学能等）
  - 效率受环境条件影响（如光照强度）
  - 可与其他能量节点形成网络，提高效率
- **进化路径**：高容量节点、专业化节点（太阳能、热能、化学能）
- **资源消耗**：中等（生物质80，能量20）
- **建造限制**：需要特定环境条件（如光照充足区域）

#### 2.2.3 矿物同化器（Mineral Assimilator）

- **功能**：收集矿物资源
- **特性**：
  - 从矿物点提取稀有元素
  - 可分解周围环境中的无机物
  - 提供建造高级建筑和单位所需的矿物资源
- **进化路径**：高效同化器、专业化同化器（针对特定矿物）
- **资源消耗**：中高（生物质100，能量70）
- **建造限制**：必须建在矿物点附近

#### 2.2.4 存储囊（Storage Sac）

- **功能**：增加资源存储容量
- **特性**：
  - 存储各类资源
  - 可专门存储某一类资源，提高效率
  - 与运输单位协同工作
- **进化路径**：大型存储囊、专业化存储囊
- **资源消耗**：中等（生物质120，能量50）
- **建造限制**：无特殊限制，但建议靠近资源收集建筑

### 2.3 生产建筑

#### 2.3.1 孵化池（Spawning Pool）

- **功能**：生产基础战斗单位
- **特性**：
  - 可同时孵化多个基础单位
  - 提供基础单位的初始进化选项
  - 单位生产速度受菌毯活力影响
- **进化路径**：高级孵化池、专业化孵化池（近战、远程等）
- **资源消耗**：中等（生物质150，能量100）
- **建造限制**：需要主巢室达到一定等级

#### 2.3.2 进化腔（Evolution Chamber）

- **功能**：生产高级单位和进化现有单位
- **特性**：
  - 允许基础单位进化为高级形态
  - 提供单位基因修改功能
  - 解锁特殊单位能力
- **进化路径**：高级进化腔、专业化进化腔
- **资源消耗**：高（生物质200，能量150，矿物50）
- **建造限制**：需要研究特定技术后解锁

#### 2.3.3 孢子塔（Spore Tower）

- **功能**：生产和发射孢子单位
- **特性**：
  - 可生产空中单位
  - 提供区域侦察能力
  - 可向远处区域传播菌毯
- **进化路径**：高级孢子塔、专业化孢子塔
- **资源消耗**：中高（生物质180，能量120）
- **建造限制**：需要菌毯活力达到一定水平

### 2.4 研究建筑

#### 2.4.1 基因库（Gene Repository）

- **功能**：研究基因相关技术
- **特性**：
  - 存储和分析收集到的基因
  - 解锁新的基因组合
  - 提高基因融合成功率
- **进化路径**：高级基因库、专业化基因库
- **资源消耗**：高（生物质200，能量180，矿物80）
- **建造限制**：每个玩家只能拥有1个

#### 2.4.2 神经节点（Neural Node）

- **功能**：研究控制和感知相关技术
- **特性**：
  - 提高单位控制效率
  - 扩大感知范围
  - 解锁高级控制能力
- **进化路径**：高级神经节点、专业化神经节点
- **资源消耗**：高（生物质180，能量220，矿物60）
- **建造限制**：需要基因库支持

#### 2.4.3 适应腔室（Adaptation Chamber）

- **功能**：研究环境适应性技术
- **特性**：
  - 提高在恶劣环境中的生存能力
  - 解锁特殊地形适应能力
  - 增强对敌对环境的抵抗力
- **进化路径**：高级适应腔室、专业化适应腔室
- **资源消耗**：中高（生物质150，能量150，矿物100）
- **建造限制**：需要特定研究解锁

### 2.5 防御建筑

#### 2.5.1 刺囊（Thorn Sac）

- **功能**：基础防御建筑
- **特性**：
  - 对接近的敌人造成伤害
  - 可检测隐形单位
  - 自动攻击范围内敌人
- **进化路径**：高级刺囊、专业化刺囊（毒素、酸性等）
- **资源消耗**：低（生物质80，能量60）
- **建造限制**：必须建在菌毯上

#### 2.5.2 孢子炮塔（Spore Cannon）

- **功能**：远程防御建筑
- **特性**：
  - 发射孢子弹幕攻击敌人
  - 范围伤害能力
  - 可对空对地
- **进化路径**：高级孢子炮塔、专业化炮塔
- **资源消耗**：中等（生物质120，能量100）
- **建造限制**：需要特定研究解锁

#### 2.5.3 粘液池（Slime Pit）

- **功能**：区域控制防御建筑
- **特性**：
  - 减缓敌人移动速度
  - 持续造成伤害
  - 提高友方单位在区域内的再生能力
- **进化路径**：高级粘液池、专业化粘液池
- **资源消耗**：中等（生物质100，能量120）
- **建造限制**：需要特定环境条件（如湿地）

#### 2.5.4 感知节点（Sensory Node）

- **功能**：侦察和预警建筑
- **特性**：
  - 扩大视野范围
  - 检测隐形单位
  - 提供敌人动向预警
- **进化路径**：高级感知节点、专业化感知节点
- **资源消耗**：低（生物质60，能量80）
- **建造限制**：无特殊限制

### 2.6 特殊建筑

#### 2.6.1 传送孔（Warp Pore）

- **功能**：单位快速移动
- **特性**：
  - 连接两个传送孔之间的单位传送
  - 减少单位移动时间
  - 可用于快速增援
- **进化路径**：高级传送孔、专业化传送孔
- **资源消耗**：高（生物质200，能量250，矿物100）
- **建造限制**：需要高级研究解锁，每对传送孔需消耗持续能量

#### 2.6.2 共生结构（Symbiotic Structure）

- **功能**：与环境生物形成共生关系
- **特性**：
  - 驯化并控制野生生物
  - 提供特殊资源或能力
  - 根据环境生物类型提供不同效果
- **进化路径**：高级共生结构、专业化共生结构
- **资源消耗**：变动（取决于目标生物）
- **建造限制**：必须建在特定生物附近

#### 2.6.3 信息素塔（Pheromone Tower）

- **功能**：增强区域内友方单位能力
- **特性**：
  - 提高区域内友方单位属性
  - 可切换不同信息素类型（攻击、防御、速度等）
  - 影响区域内菌毯生长速度
- **进化路径**：高级信息素塔、专业化信息素塔
- **资源消耗**：中高（生物质150，能量180）
- **建造限制**：需要特定研究解锁

## 3. 建筑机制

### 3.1 建造机制

#### 3.1.1 建造前提

- 必须在菌毯覆盖区域内建造
- 特定建筑需要特定环境条件
- 部分高级建筑需要研究解锁
- 建筑之间需保持最小距离

#### 3.1.2 建造过程

- 由工作单位指定位置并开始建造
- 建筑从菌毯中缓慢生长出来
- 建造速度受工作单位数量和菌毯活力影响
- 建造过程可视化为有机生长过程

#### 3.1.3 建造资源

- 主要消耗生物质和能量
- 高级建筑额外需要矿物资源
- 特殊建筑可能需要特殊资源

### 3.2 进化机制

#### 3.2.1 进化条件

- 建筑达到一定使用时间
- 满足特定资源条件
- 研究相关技术
- 环境条件影响（如特定区域可解锁特殊进化）

#### 3.2.2 进化路径

- 每种建筑有多条可能的进化路径
- 玩家可选择专业化方向
- 进化选择不可逆，增加策略性
- 环境可能影响可用的进化选项

#### 3.2.3 进化效果

- 提高基础功能效率
- 解锁新功能
- 改变外观和动画效果
- 可能改变资源消耗

### 3.3 维护机制

#### 3.3.1 健康度系统

- 建筑有健康度属性
- 受到攻击会降低健康度
- 可通过工作单位修复
- 健康度过低会影响功能效率

#### 3.3.2 能量消耗

- 大多数建筑持续消耗少量能量
- 特殊功能可能需要额外能量
- 能量不足会降低效率或暂停功能
- 可通过升级降低能量消耗

#### 3.3.3 适应性调整

- 建筑可根据环境条件自动调整
- 长期处于特定环境可获得适应性加成
- 环境恶化可能导致建筑退化
- 提供玩家应对环境变化的策略选择

### 3.4 互动机制

#### 3.4.1 建筑协同

- 相近的相关建筑可形成协同效应
- 特定建筑组合可触发特殊效果
- 建筑网络可提高整体效率
- 鼓励玩家规划建筑布局

#### 3.4.2 建筑与单位互动

- 单位可从特定建筑获得增益
- 某些单位可强化建筑功能
- 特殊单位可加速建筑修复
- 提供单位与建筑协同策略

#### 3.4.3 建筑与菌毯互动

- 建筑影响周围菌毯活力
- 菌毯状态反过来影响建筑效率
- 特定建筑可加速菌毯扩张
- 形成有机的生态系统循环

## 4. 视觉与音效设计

### 4.0 美术资源需求

#### 4.0.1 建筑模型资源需求

| 建筑类型 | 基础形态 | 进化形态 | 环境变种 | 总模型数量 | 优先级 |
|---------|---------|---------|---------|-----------|-------|
| 主巢室 | 1个基础模型 | 3个进化阶段 | 5种环境适应 | 15个 | 最高 |
| 次级巢室 | 1个基础模型 | 3种专业化 | 5种环境适应 | 15个 | 高 |
| 资源建筑 | 4种基础类型 | 每种2个进化形态 | 3种环境适应 | 36个 | 高 |
| 生产建筑 | 3种基础类型 | 每种2个进化形态 | 3种环境适应 | 27个 | 高 |
| 研究建筑 | 3种基础类型 | 每种2个进化形态 | 2种环境适应 | 18个 | 中 |
| 防御建筑 | 4种基础类型 | 每种2个进化形态 | 3种环境适应 | 36个 | 高 |
| 特殊建筑 | 3种基础类型 | 每种2个进化形态 | 2种环境适应 | 18个 | 低 |

#### 4.0.2 建筑动画资源需求

| 动画类型 | 每个建筑所需动画 | 总动画数量 | 优先级 |
|---------|----------------|-----------|-------|
| 建造动画 | 每种建筑1个 | 18个 | 高 |
| 闲置动画 | 每种建筑1个 | 18个 | 高 |
| 工作动画 | 每种建筑1-3个 | 约45个 | 中 |
| 进化动画 | 每种进化路径1个 | 约36个 | 中 |
| 损毁动画 | 每种建筑1个 | 18个 | 低 |
| 修复动画 | 每种建筑1个 | 18个 | 低 |
| 特殊效果 | 视建筑功能而定 | 约20个 | 低 |

#### 4.0.3 建筑纹理资源需求

| 纹理类型 | 数量 | 分辨率 | 格式 | 优先级 |
|---------|------|-------|------|-------|
| 基础纹理 | 每种建筑1套 | 2048x2048 | PBR (Albedo, Normal, Metallic, Roughness) | 高 |
| 进化纹理变化 | 每种进化形态1套 | 2048x2048 | PBR | 中 |
| 环境适应纹理 | 每种环境类型1套 | 1024x1024 | 叠加纹理 | 低 |
| 损伤纹理 | 3种损伤等级 | 1024x1024 | 叠加纹理 | 低 |
| 发光纹理 | 功能性建筑使用 | 1024x1024 | 自发光贴图 | 中 |

#### 4.0.4 建筑特效资源需求

| 特效类型 | 数量 | 复杂度 | 优先级 |
|---------|------|-------|-------|
| 建造特效 | 6种基本类型 | 中 | 高 |
| 功能激活特效 | 每种建筑功能1个 | 中-高 | 中 |
| 环境交互特效 | 每种环境类型2-3个 | 中 | 低 |
| 损毁特效 | 3种基本类型 | 低 | 低 |
| 进化特效 | 3种基本类型 | 高 | 中 |

#### 4.0.5 美术资源开发时间估计

| 资源类型 | 开发时间（人/天） | 总计（人/天） |
|---------|----------------|------------|
| 概念设计 | 每种建筑类型3天 | 21天 |
| 3D模型制作 | 每个基础模型5天 | 90天 |
| 进化形态变体 | 每个变体2天 | 72天 |
| 环境适应变体 | 每个变体1天 | 54天 |
| 纹理制作 | 每套纹理2天 | 36天 |
| 动画制作 | 每个动画1-3天 | 约153天 |
| 特效制作 | 每个特效1-2天 | 约45天 |
| 整合与测试 | 总工作量的20% | 约94天 |
| **总计** | | **约565人/天** |

### 4.1 建筑外观设计

#### 4.1.1 设计原则

- 有机、生物质感的外观
- 明确的功能视觉识别
- 进化阶段有明显视觉差异
- 与环境的自然融合

#### 4.1.2 动态变化

- 建筑呈现微小的呼吸或脉动
- 功能激活时有明显视觉反馈
- 健康度变化反映在外观上
- 随时间和使用呈现磨损或生长

#### 4.1.3 环境适应

- 在不同生物群落中外观略有变化
- 反映环境条件（如极寒区域结霜）
- 昼夜循环影响外观（如夜间发光）
- 增强游戏世界的沉浸感

### 4.2 建筑动画

#### 4.2.1 建造动画

- 从菌毯中有机生长过程
- 分阶段展现结构形成
- 周围菌毯的反应变化
- 完成时的"激活"效果

#### 4.2.2 功能动画

- 资源收集建筑的吸收/提取动画
- 生产建筑的孵化/组装动画
- 防御建筑的警戒/攻击动画
- 研究建筑的能量波动动画

#### 4.2.3 损毁与修复动画

- 受损时的有机组织损伤效果
- 严重损坏时的功能退化表现
- 修复过程的组织再生效果
- 废弃时的腐败/分解效果

### 4.3 音效设计

#### 4.3.1 建筑音效

- 有机、湿润的建造声音
- 功能运行时的环境音（如提取器的吸收声）
- 不同建筑类型的独特音效识别
- 损毁和修复的相应音效

#### 4.3.2 环境互动音效

- 建筑与菌毯互动的声音
- 对环境变化的声音反应
- 与单位互动时的反馈音
- 增强游戏世界的声音层次

## 5. 界面设计

### 5.1 建造界面

#### 5.1.1 建筑分类

- 按功能类别清晰分组
- 显示解锁条件和前置需求
- 已解锁但不可建造的建筑（如资源不足）有明确标识
- 特殊环境才能建造的建筑有环境提示

#### 5.1.2 信息显示

- 资源消耗明确标注
- 建筑功能简明描述
- 建造时间估计
- 可能的进化路径预览

#### 5.1.3 建造辅助

- 有效建造区域高亮显示
- 无效位置放置时有反馈提示
- 建筑间距离限制可视化
- 快捷键和拖放操作支持

### 5.2 建筑管理界面

#### 5.2.1 状态监控

- 健康度和功能效率显示
- 当前活动和队列状态
- 资源产出/消耗实时数据
- 异常状态警告（如能量不足）

#### 5.2.2 功能控制

- 生产队列管理
- 研究项目选择
- 特殊能力激活
- 进化选项选择

#### 5.2.3 信息统计

- 历史产出/消耗图表
- 效率分析和建议
- 与其他同类建筑比较
- 贡献度评估

### 5.3 小地图整合

#### 5.3.1 建筑标识

- 不同类型建筑有独特图标
- 建筑状态通过颜色变化表示
- 重要建筑有突出显示
- 可筛选显示特定类型建筑

#### 5.3.2 区域影响可视化

- 建筑影响范围在小地图上显示
- 建筑网络连接可视化
- 防御覆盖区域标识
- 资源收集效率热图

## 6. 平衡设计

### 6.1 资源平衡

#### 6.1.1 建造成本

- 基础建筑成本较低，高级建筑成本指数增长
- 专业化建筑比通用建筑成本高但效率更高
- 防御建筑成本与攻击力/防御力成正比
- 特殊建筑有独特资源需求

#### 6.1.2 维护消耗

- 建筑规模与维护成本成正比
- 闲置建筑维护成本降低
- 过度集中建筑会增加整体维护成本
- 环境适应性影响维护效率

#### 6.1.3 产出效率

- 资源建筑初始产出适中，升级后显著提高
- 环境条件对产出有乘数效应
- 建筑网络可提供产出加成
- 过度开采会导致效率下降

### 6.2 时间平衡

#### 6.2.1 建造时间

- 与建筑复杂度和规模成正比
- 可通过增加工作单位数量加速
- 特殊环境可能延长或缩短建造时间
- 研究技术可减少建造时间

#### 6.2.2 研究时间

- 基础研究较快，高级研究耗时长
- 多个研究建筑可并行研究不同项目
- 特定建筑组合可加速特定研究
- 环境因素影响研究效率

#### 6.2.3 进化时间

- 简单进化较快，复杂进化需要时间
- 进化过程中建筑功能减弱
- 可通过特殊资源加速进化
- 环境变化可能中断进化过程

### 6.3 空间平衡

#### 6.3.1 建筑占地

- 功能复杂度与占地面积成正比
- 高级建筑需要更大空间
- 建筑之间需要保持最小距离
- 特定建筑可以垂直生长节省空间

#### 6.3.2 影响范围

- 不同建筑有不同的效果范围
- 范围可通过研究和升级扩大
- 建筑重叠范围有协同或抵消效应
- 地形和障碍物影响实际范围

#### 6.3.3 布局策略

- 鼓励战略性建筑布局
- 核心区域与前线建筑差异化
- 资源点周围建筑规划
- 防御网络的最优布局

## 7. 与其他系统的交互

### 7.1 与菌毯系统交互

#### 7.1.1 依赖关系

- 建筑必须建在菌毯上
- 菌毯活力影响建筑效率
- 特定建筑可加速菌毯扩张
- 菌毯退化会影响建筑健康度

#### 7.1.2 资源循环

- 建筑从菌毯获取基础养分
- 部分废弃物返回菌毯循环利用
- 特殊建筑可改变菌毯特性
- 形成生态系统闭环

### 7.2 与单位系统交互

#### 7.2.1 生产关系

- 特定建筑生产对应单位
- 建筑等级限制可生产单位等级
- 建筑特性影响生产单位属性
- 单位可继承建筑的部分特性

#### 7.2.2 建筑与单位对应表

| 建筑名称 | 可生产单位 | 建筑等级要求 | 特殊要求 |
|---------|-----------|------------|---------|
| **主巢室** | 工作单位、基础采集者 | 1级 | 无 |
| **主巢室（高级）** | 高级工作单位、高效采集者 | 3级 | 需要基因研究 |
| **孵化池** | 基础战斗单位（近战爪兵、远程酸液兵） | 1级 | 无 |
| **孵化池（高级）** | 中级战斗单位（重型爪兵、穿透酸液兵） | 2级 | 需要进化腔支持 |
| **进化腔** | 高级战斗单位（统御级单位） | 1级 | 需要基因库支持 |
| **进化腔（高级）** | 精英战斗单位（异变体、完美适应体） | 3级 | 需要特定基因组合 |
| **孢子塔** | 空中单位（侦察孢子、攻击孢子） | 1级 | 无 |
| **孢子塔（高级）** | 高级空中单位（孢子云团、孢子风暴） | 2级 | 需要特定环境条件 |
| **共生结构** | 共生单位（寄生体、控制体） | 1级 | 需要野生生物 |
| **共生结构（高级）** | 高级共生单位（完全融合体） | 3级 | 需要特定基因研究 |

#### 7.2.3 单位解锁路径

- **基础单位**：游戏开始即可通过主巢室和基础孵化池生产
- **中级单位**：需要建造进化腔并研究相应基因
- **高级单位**：需要高级进化腔和特定基因组合
- **精英单位**：需要专业化建筑和稀有基因序列
- **特殊单位**：需要特殊建筑组合和环境条件

#### 7.2.4 功能协同

- 特定单位可增强建筑功能
- 建筑可为单位提供增益效果
- 单位可修复和升级建筑
- 特殊单位-建筑组合触发独特能力

### 7.3 与基因系统交互

#### 7.3.1 基因影响

- 解锁的基因影响可建造的建筑类型
- 基因突变可能解锁特殊建筑
- 建筑可继承基因特性
- 基因组合影响建筑进化路径

#### 7.3.2 研究协同

- 建筑研究解锁新基因
- 基因库建筑存储和分析基因
- 特定基因组合可加速建筑研究
- 形成研究-发现-应用循环

### 7.4 与环境系统交互

#### 7.4.1 环境适应

- 建筑会适应所在环境
- 不同环境影响建筑效率
- 特殊环境解锁特殊建筑功能
- 环境变化需要建筑调整

#### 7.4.2 环境改造

- 建筑群可逐渐改变局部环境
- 特定建筑可加速环境转变
- 环境改造可能引发连锁反应
- 提供战略性地形改造选择

## 8. 游戏进程中的建筑系统

### 8.1 早期阶段

#### 8.1.1 可用建筑

- 主巢室（初始提供）
- 基础养分提取器
- 简易能量节点
- 基础孵化池
- 初级防御刺囊

#### 8.1.2 早期策略

- 快速建立资源收集网络
- 扩展菌毯覆盖范围
- 建立基础防御体系
- 为中期发展奠定基础

### 8.2 中期阶段

#### 8.2.1 新解锁建筑

- 次级巢室
- 进化腔
- 基因库
- 矿物同化器
- 高级防御建筑

#### 8.2.2 中期策略

- 建立专业化建筑群
- 开始建筑进化路线选择
- 扩展到新资源区域
- 加强防御网络

### 8.3 后期阶段

#### 8.3.1 高级建筑

- 特殊功能建筑
- 高度专业化建筑
- 传送网络
- 环境改造建筑

#### 8.3.2 后期策略

- 建立高效建筑网络
- 完成建筑进化树
- 优化资源利用
- 建立攻防一体的建筑体系

## 9. 技术实现

### 9.1 建筑数据结构

```csharp
public class Building : MonoBehaviour
{
    // 基础属性
    public string buildingId;
    public string buildingName;
    public BuildingType type;
    public int level;
    public float healthPoints;
    public float maxHealthPoints;
    
    // 资源相关
    public ResourceCost buildCost;
    public ResourceCost maintenanceCost;
    public ResourceProduction resourceProduction;
    
    // 功能相关
    public List<BuildingFunction> functions;
    public List<BuildingAbility> abilities;
    public List<EvolutionPath> evolutionPaths;
    
    // 状态相关
    public BuildingState currentState;
    public float constructionProgress;
    public float efficiency;
    
    // 环境交互
    public float myceliumInfluence;
    public Dictionary<EnvironmentType, float> environmentAdaptation;
    
    // 视觉和音效
    public List<BuildingVisualStage> visualStages;
    public List<AudioClip> buildingSounds;
    
    // 方法
    public void Initialize();
    public void UpdateState();
    public void ProcessProduction();
    public void TakeDamage(float amount);
    public void Repair(float amount);
    public void Evolve(EvolutionPath path);
    public void AdjustToEnvironment(EnvironmentType environment);
}
```

### 9.2 建筑管理器

```csharp
public class BuildingManager : MonoBehaviour
{
    // 单例实例
    public static BuildingManager Instance { get; private set; }
    
    // 建筑集合
    public Dictionary<string, Building> allBuildings;
    public List<Building> activeBuildings;
    
    // 建筑预制体
    public Dictionary<string, GameObject> buildingPrefabs;
    
    // 建造相关
    public bool CanBuildAt(Vector3 position, string buildingId);
    public Building StartConstruction(Vector3 position, string buildingId);
    public void CancelConstruction(Building building);
    public void CompleteConstruction(Building building);
    
    // 管理方法
    public void UpdateAllBuildings();
    public List<Building> GetBuildingsOfType(BuildingType type);
    public List<Building> GetBuildingsInRange(Vector3 position, float range);
    public void RemoveBuilding(Building building);
    
    // 资源计算
    public ResourceAmount CalculateTotalProduction();
    public ResourceAmount CalculateTotalMaintenance();
}
```

### 9.3 建筑与菌毯交互

```csharp
public class BuildingMyceliumInteraction : MonoBehaviour
{
    // 引用
    public Building building;
    public MyceliumManager myceliumManager;
    
    // 交互参数
    public float influenceRadius;
    public float influenceStrength;
    public MyceliumInfluenceType influenceType;
    
    // 方法
    public void UpdateMyceliumInfluence();
    public float GetMyceliumVitality();
    public void OnMyceliumStateChanged(MyceliumState newState);
}
```

## 10. 测试与平衡

### 10.1 功能测试

#### 10.1.1 建造测试

- 验证所有建筑可正常建造
- 测试建筑位置限制
- 验证资源消耗正确
- 测试建造过程可视化

#### 10.1.2 功能测试

- 验证各类建筑功能正常运行
- 测试资源生产和消耗
- 验证单位生产功能
- 测试研究和进化功能

#### 10.1.3 交互测试

- 测试建筑与菌毯交互
- 验证建筑与单位互动
- 测试环境对建筑的影响
- 验证建筑网络效应

### 10.2 平衡测试

#### 10.2.1 资源平衡

- 测试建造成本与游戏进程匹配
- 验证资源产出与消耗平衡
- 测试不同建筑路线的资源效率
- 验证经济系统整体平衡

#### 10.2.2 时间平衡

- 测试建造时间合理性
- 验证研究和进化时间曲线
- 测试游戏不同阶段的时间流
- 验证玩家等待时间体验

#### 10.2.3 难度平衡

- 测试AI对建筑系统的利用
- 验证不同难度下的建筑系统表现
- 测试极端情况下的系统稳定性
- 验证新手引导的有效性

### 10.3 用户体验测试

#### 10.3.1 界面测试

- 测试建造界面易用性
- 验证信息显示清晰度
- 测试操作流程顺畅度
- 验证反馈机制有效性

#### 10.3.2 视觉测试

- 测试建筑视觉效果
- 验证动画流畅度
- 测试不同环境下的视觉适应
- 验证整体美术风格一致性

#### 10.3.3 音效测试

- 测试建筑音效
- 验证音效与动作同步
- 测试环境音与建筑音的混合
- 验证音效反馈的有效性

## 11. 未来扩展

### 11.1 新建筑类型

- 混合功能建筑
- 超大型集群建筑
- 移动式建筑
- 地下建筑网络

### 11.2 新机制

- 建筑变异系统
- 建筑寄生机制
- 建筑融合技术
- 临时性建筑

### 11.3 玩家自定义

- 建筑外观自定义
- 功能组合定制
- 进化路径设计
- 建筑模板系统

## 12. 美术资源详细规格

### 12.1 建筑模型详细规格

#### 12.1.1 主巢室系列

| 模型名称 | 英文名称 | 多边形预算 | 贴图尺寸 | 动画需求 | 特效需求 | 优先级 |
|---------|---------|-----------|---------|---------|---------|-------|
| 主巢室-基础 | BLD_HiveCore_Base | 8000-10000 | 2048x2048 | 建造、闲置、生产、受损 | 能量脉动、孵化 | 最高 |
| 主巢室-二级 | BLD_HiveCore_Tier2 | 10000-12000 | 2048x2048 | 同上+升级 | 同上+能量场 | 高 |
| 主巢室-三级 | BLD_HiveCore_Tier3 | 12000-15000 | 2048x2048 | 同上+特殊能力 | 同上+控制波纹 | 中 |
| 次级巢室-基础 | BLD_SubHive_Base | 6000-8000 | 2048x2048 | 建造、闲置、扩张 | 菌毯扩张、能量脉动 | 高 |
| 次级巢室-资源型 | BLD_SubHive_Resource | 7000-9000 | 2048x2048 | 同上+资源收集 | 同上+资源流动 | 中 |
| 次级巢室-军事型 | BLD_SubHive_Military | 7000-9000 | 2048x2048 | 同上+单位生产 | 同上+战斗光环 | 中 |
| 次级巢室-研究型 | BLD_SubHive_Research | 7000-9000 | 2048x2048 | 同上+研究 | 同上+数据流 | 低 |

#### 12.1.2 资源建筑系列

| 模型名称 | 英文名称 | 多边形预算 | 贴图尺寸 | 动画需求 | 特效需求 | 优先级 |
|---------|---------|-----------|---------|---------|---------|-------|
| 养分提取器-基础 | BLD_NutrientExtractor_Base | 4000-6000 | 1024x1024 | 建造、闲置、提取 | 吸收、传输 | 高 |
| 养分提取器-高效 | BLD_NutrientExtractor_Advanced | 5000-7000 | 1024x1024 | 同上 | 同上+效率光环 | 中 |
| 能量节点-基础 | BLD_EnergyNode_Base | 3000-5000 | 1024x1024 | 建造、闲置、收集 | 能量波动、传输 | 高 |
| 能量节点-高容量 | BLD_EnergyNode_HighCapacity | 4000-6000 | 1024x1024 | 同上+储能 | 同上+能量场 | 中 |
| 矿物同化器-基础 | BLD_MineralAssimilator_Base | 4000-6000 | 1024x1024 | 建造、闲置、分解 | 矿物光芒、传输 | 高 |
| 矿物同化器-高效 | BLD_MineralAssimilator_Advanced | 5000-7000 | 1024x1024 | 同上+精炼 | 同上+精炼光环 | 中 |
| 存储囊-基础 | BLD_StorageSac_Base | 3000-5000 | 1024x1024 | 建造、闲置、存储 | 资源流动 | 中 |
| 存储囊-大型 | BLD_StorageSac_Large | 4000-6000 | 1024x1024 | 同上 | 同上+容量指示 | 低 |

#### 12.1.3 生产建筑系列

| 模型名称 | 英文名称 | 多边形预算 | 贴图尺寸 | 动画需求 | 特效需求 | 优先级 |
|---------|---------|-----------|---------|---------|---------|-------|
| 孵化池-基础 | BLD_SpawningPool_Base | 5000-7000 | 2048x2048 | 建造、闲置、孵化 | 生命能量、孵化 | 高 |
| 孵化池-高级 | BLD_SpawningPool_Advanced | 6000-8000 | 2048x2048 | 同上+进化 | 同上+基因链 | 中 |
| 进化腔-基础 | BLD_EvolutionChamber_Base | 6000-8000 | 2048x2048 | 建造、闲置、进化 | 基因重组、能量场 | 高 |
| 进化腔-高级 | BLD_EvolutionChamber_Advanced | 7000-9000 | 2048x2048 | 同上+高级进化 | 同上+突变光环 | 中 |
| 孢子塔-基础 | BLD_SporeTower_Base | 5000-7000 | 2048x2048 | 建造、闲置、发射 | 孢子云、传播 | 高 |
| 孢子塔-高级 | BLD_SporeTower_Advanced | 6000-8000 | 2048x2048 | 同上+大规模发射 | 同上+孢子风暴 | 中 |

#### 12.1.4 研究与防御建筑系列

| 模型名称 | 英文名称 | 多边形预算 | 贴图尺寸 | 动画需求 | 特效需求 | 优先级 |
|---------|---------|-----------|---------|---------|---------|-------|
| 基因库-基础 | BLD_GeneRepository_Base | 5000-7000 | 2048x2048 | 建造、闲置、研究 | 数据流、基因链 | 高 |
| 神经节点-基础 | BLD_NeuralNode_Base | 4000-6000 | 1024x1024 | 建造、闲置、传输 | 神经脉冲、控制波 | 中 |
| 适应腔室-基础 | BLD_AdaptationChamber_Base | 5000-7000 | 1024x1024 | 建造、闲置、适应 | 环境模拟、变异 | 中 |
| 刺囊-基础 | BLD_ThornSac_Base | 3000-5000 | 1024x1024 | 建造、闲置、攻击 | 刺击、毒素 | 高 |
| 孢子炮塔-基础 | BLD_SporeCannon_Base | 4000-6000 | 1024x1024 | 建造、闲置、攻击 | 孢子弹幕、爆炸 | 高 |
| 粘液池-基础 | BLD_SlimePit_Base | 3000-5000 | 1024x1024 | 建造、闲置、减速 | 粘液扩散、腐蚀 | 中 |
| 感知节点-基础 | BLD_SensoryNode_Base | 2000-4000 | 1024x1024 | 建造、闲置、扫描 | 感知波纹、警报 | 中 |

### 12.2 建筑环境适应变体

每种基础建筑需要以下环境适应变体，每个变体在基础模型上进行修改，保持核心识别特征：

| 环境类型 | 英文后缀 | 视觉特征 | 纹理变化 | 优先级 |
|---------|---------|---------|---------|-------|
| 沼泽环境 | _Swamp | 更多藻类生长，湿润外观 | 增加绿色色调，水渍效果 | 高 |
| 荒漠环境 | _Desert | 干燥外观，保护层增厚 | 增加棕色色调，裂纹纹理 | 高 |
| 冰原环境 | _Tundra | 结霜外观，保温结构 | 增加蓝色色调，冰晶效果 | 中 |
| 洞穴环境 | _Cave | 发光组织，垂直生长趋势 | 增加发光效果，苔藓纹理 | 中 |
| 污染环境 | _Contaminated | 异常生长，防御性结构 | 增加紫色色调，异常生长纹理 | 低 |

### 12.3 建筑动画规格

#### 12.3.1 通用动画

| 动画类型 | 英文名称 | 帧率 | 时长(秒) | 循环类型 | 优先级 |
|---------|---------|------|---------|---------|-------|
| 建造动画 | Construct | 30 | 3-5 | 一次性 | 高 |
| 闲置动画 | Idle | 30 | 5-10 | 循环 | 高 |
| 工作动画 | Working | 30 | 3-8 | 循环 | 高 |
| 受损动画 | Damaged | 30 | 持续 | 状态 | 中 |
| 修复动画 | Repair | 30 | 3-5 | 一次性 | 中 |
| 升级动画 | Upgrade | 30 | 5-8 | 一次性 | 中 |
| 销毁动画 | Destroy | 30 | 2-4 | 一次性 | 低 |

#### 12.3.2 特殊动画

| 建筑类型 | 特殊动画 | 英文名称 | 帧率 | 时长(秒) | 优先级 |
|---------|---------|---------|------|---------|-------|
| 主巢室 | 单位生产 | UnitProduction | 30 | 2-3 | 高 |
| 孵化池 | 孵化过程 | Hatching | 30 | 4-6 | 高 |
| 进化腔 | 基因重组 | GeneRecombination | 30 | 5-8 | 高 |
| 孢子塔 | 孢子发射 | SporeRelease | 30 | 2-3 | 高 |
| 基因库 | 数据分析 | DataAnalysis | 30 | 4-8 | 中 |
| 刺囊 | 攻击动作 | Attack | 30 | 1-2 | 高 |
| 孢子炮塔 | 充能与发射 | ChargeAndFire | 30 | 2-3 | 高 |

### 12.4 建筑特效规格

| 特效类型 | 英文名称 | 粒子数量级 | 持续时间 | 影响范围 | 优先级 |
|---------|---------|-----------|---------|---------|-------|
| 能量脉动 | EnergyPulse | 中 | 循环 | 建筑周围 | 高 |
| 菌毯扩张 | MyceliumExpansion | 高 | 持续 | 大范围 | 高 |
| 资源收集 | ResourceCollection | 中 | 循环 | 中范围 | 高 |
| 基因链显示 | GeneChainDisplay | 中 | 循环 | 建筑内部 | 中 |
| 防御攻击 | DefensiveAttack | 高 | 短暂 | 中远范围 | 高 |
| 环境适应 | EnvironmentalAdaptation | 低 | 一次性 | 建筑本身 | 中 |
| 建筑损毁 | BuildingDamage | 高 | 短暂 | 建筑本身 | 中 |
| 建筑修复 | BuildingRepair | 中 | 短暂 | 建筑本身 | 中 |

## 13. 总结

建筑系统作为《深渊巢穴》的核心系统之一，通过其有机性、进化性和环境适应性，为玩家提供了独特的游戏体验。系统设计注重与其他核心系统的深度融合，形成一个有机的生态系统。通过精心的平衡和丰富的视觉表现，建筑系统不仅是功能性的游戏元素，更是塑造游戏世界观和美学风格的重要组成部分。

本文档详细规定了建筑系统的需求规范，包括功能定义、视觉设计、交互机制以及与其他系统的关联。同时，提供了详尽的美术资源规格，确保开发团队能够准确理解并实现设计意图。所有命名和术语均遵循《深渊巢穴命名规范与术语表》，确保项目各部分保持一致性。

未来的开发将继续完善建筑系统，增加更多样化的建筑类型和交互机制，进一步强化《深渊巢穴》的独特游戏体验。
